federal_cnae_fuel_alltaxes <- df_federal_cnae_date %>%
select(ano,                    # Year
ano_mes_date,           # Year and month in date format
secao_sigla,            # Economic sector classification
imposto_importacao,     # Import tax
pis_pasep,              # Tax to fund social benefits
imposto_exportacao,     # Export tax
cofins,                 # Tax to fund social securite
cide_combustiveis) %>%  # Tax on fuel to fund infrastructure and fuel subsidies
rename(ii = imposto_importacao,
ie = imposto_exportacao) %>%
replace(is.na(.),0) %>%
mutate(fuel_taxes = ii + pis_pasep + ie + cofins + cide_combustiveis)
federal_allsectors_unpivot <- federal_cnae_fuel_alltaxes %>%
select(-ano_mes_date) %>%
pivot_longer(
cols = c(pis_pasep, ii, ie, cofins, cide_combustiveis, fuel_taxes),
names_to = "tax_type",
values_to = "value") %>%
left_join(cnae_sector_names, by = "secao_sigla") %>%
select(ano, tax_type, value) %>%
drop_na()
federal_allsectors_unpivot <- federal_allsectors_unpivot %>%
filter(tax_type != "fuel_taxes") %>%
mutate(tax_type = case_when(
tax_type == "pis_pasep" ~ "PIS/PASEP",
tax_type == "ii"        ~ "Import Tax",
tax_type == "ie"        ~ "Export Tax",
tax_type == "cofins"    ~ "COFINS",
tax_type == "cide_combustiveis"    ~ "CIDE Combustíveis",
TRUE ~ tax_type # Keep original value if no match
))
federal_allsectors_unpivot <- federal_cnae_fuel_alltaxes %>%
select(-ano_mes_date) %>%
group_by(ano) %>%
summarise(
pis_pasep = sum(pis_pasep))
federal_allsectors_unpivot <- federal_cnae_fuel_alltaxes %>%
select(-ano_mes_date) %>%
group_by(ano) %>%
summarise(
pis_pasep         = sum(pis_pasep),
ii                = sum(ii),
ie                = sum(ie),
cofins            = sum(cofins),
cide_combustiveis = sum(cide_combustiveis),
fuel_taxes        = sum(fuel_taxes))
federal_allsectors_unpivot <- federal_cnae_fuel_alltaxes %>%
select(-ano_mes_date) %>%
group_by(ano) %>%
summarise(
pis_pasep         = sum(pis_pasep),
ii                = sum(ii),
ie                = sum(ie),
cofins            = sum(cofins),
cide_combustiveis = sum(cide_combustiveis),
fuel_taxes        = sum(fuel_taxes)) %>%
pivot_longer(
cols = c(pis_pasep, ii, ie, cofins, cide_combustiveis, fuel_taxes),
names_to = "tax_type",
values_to = "value") %>%
left_join(cnae_sector_names, by = "secao_sigla") %>%
select(ano, tax_type, value) %>%
drop_na()
federal_allsectors_unpivot <- federal_cnae_fuel_alltaxes %>%
select(-ano_mes_date) %>%
group_by(ano) %>%
summarise(
pis_pasep         = sum(pis_pasep),
ii                = sum(ii),
ie                = sum(ie),
cofins            = sum(cofins),
cide_combustiveis = sum(cide_combustiveis),
fuel_taxes        = sum(fuel_taxes)) %>%
pivot_longer(
cols = c(pis_pasep, ii, ie, cofins, cide_combustiveis, fuel_taxes),
names_to = "tax_type",
values_to = "value")
federal_allsectors_unpivot <- federal_allsectors_unpivot %>%
filter(tax_type != "fuel_taxes") %>%
mutate(tax_type = case_when(
tax_type == "pis_pasep" ~ "PIS/PASEP",
tax_type == "ii"        ~ "Import Tax",
tax_type == "ie"        ~ "Export Tax",
tax_type == "cofins"    ~ "COFINS",
tax_type == "cide_combustiveis"    ~ "CIDE Combustíveis",
TRUE ~ tax_type # Keep original value if no match
))
federal_allsectors_unpivot
plot_trend_fed_revenue_alltaxes_taxtype <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024"
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype
federal_allsectors_unpivot <- federal_allsectors_unpivot %>%
federal_allsectors_unpivot <- federal_allsectors_unpivot %>%
filter(tax_type != "fuel_taxes") %>%
mutate(tax_type = case_when(
tax_type == "pis_pasep" ~ "PIS/PASEP",
tax_type == "ii"        ~ "Import Tax",
tax_type == "ie"        ~ "Export Tax",
tax_type == "cofins"    ~ "COFINS",
tax_type == "cide_combustiveis"    ~ "CIDE Combustíveis",
TRUE ~ tax_type # Keep original value if no match
)) %>%
mutate(ano = as.Date(paste(ano, "01", "01", sep = "-")))
federal_allsectors_unpivot <- federal_allsectors_unpivot %>%
filter(tax_type != "fuel_taxes") %>%
mutate(tax_type = case_when(
tax_type == "pis_pasep" ~ "PIS/PASEP",
tax_type == "ii"        ~ "Import Tax",
tax_type == "ie"        ~ "Export Tax",
tax_type == "cofins"    ~ "COFINS",
tax_type == "cide_combustiveis"    ~ "CIDE Combustíveis",
TRUE ~ tax_type # Keep original value if no match
)) %>%
mutate(ano = as.Date(paste(ano, "01", "01", sep = "-")))
plot_trend_fed_revenue_alltaxes_taxtype <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024"
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype
plot_trend_fed_revenue_alltaxes_taxtype <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type"  # Legend title
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom"  # Move legend to bottom
) +
scale_color_brewer(palette = "Set2")  # Use a colorblind-friendly palette
plot_trend_fed_revenue_alltaxes_taxtype
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024"
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type"  # Legend title
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom"  # Move legend to bottom
) +
scale_color_brewer(palette = "Set2")  # Use a colorblind-friendly palette
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_panels.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_panels)
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_1panel.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_1panel)
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type"
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
) +
scale_color_brewer(palette = "Set2")  #
plot_trend_fed_revenue_alltaxes_taxtype_1panel
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis is a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. \n CIDE Combustíveis is a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. \n CIDE Combustíveis is a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.caption = element_text(hjust = 0))
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. \n CIDE Combustíveis is a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.caption = element_text(hjust = 0))
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. \n CIDE Combustíveis is a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.caption = element_text(hjust = 0)) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis is \na tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.caption = element_text(hjust = 0)) +
facet_wrap(~ tax_type, nrow = 2)
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis is \na tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right"
plot.caption = element_text(hjust = 0)) +
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis is \na tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.caption = element_text(hjust = 0)) +
scale_color_brewer(palette = "Set2")  #
plot_trend_fed_revenue_alltaxes_taxtype_1panel
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits.\nCIDE Combustíveis is levied on fuel-related economic activities, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.caption = element_text(hjust = 0)) +
scale_color_brewer(palette = "Set2")  #
plot_trend_fed_revenue_alltaxes_taxtype_1panel
plot_trend_fed_revenue_alltaxes_taxtype_panels
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis is \na tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.caption = element_text(hjust = 0)) +
scale_color_brewer(palette = "Set2")  #
plot_trend_fed_revenue_alltaxes_taxtype_1panel
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_1panel.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_1panel)
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_panels.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_panels)
plot_trend_fed_revenue_alltaxes_taxtype_panels <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value)) +
geom_line(linewidth = 0.7) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B"))+
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis \nis a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.caption = element_text(hjust = 0)) +
facet_wrap(~ tax_type, nrow = 2)
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_panels.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_panels)
plot_trend_fed_revenue_alltaxes_taxtype_1panel <- ggplot(federal_allsectors_unpivot,
aes(x = ano,
y = value,
color = tax_type)) +  # Add color aesthetic
geom_line(linewidth = 1) +
theme_bw() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(trans = "log10",
breaks = c(1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11),
labels = c("100k", "1M", "10M", "100M", "1B", "10B", "100B")) +
labs(
x = "Year",
y = "Total Tax Revenue per Month (BRL) - log transformed",
title = "Total Federal Tax Revenue levied on Fuel-Related Economic Activities",
subtitle = "Source: Special Secretariat of the Federal Revenue of Brazil (RFB), 2024",
color = "Tax Type",
caption = "Note: COFINS and PIS/PASEP are taxes levied to fund public social security and benefits. CIDE Combustíveis \nis a tax for fuel-related economic activities only, used to fund infrastructure and fuel subsidies."
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.caption = element_text(hjust = 0)) +
scale_color_brewer(palette = "Set2")  #
ggsave("./4_plots/plot_trend_fed_revenue_alltaxes_taxtype_1panel.png",
plot = plot_trend_fed_revenue_alltaxes_taxtype_1panel)
